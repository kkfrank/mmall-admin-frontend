(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{154:function(e,t,n){},202:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var r=n(0),o=n.n(r),a=n(24),i=n(1),c=n.n(i),u=n(82),l=n(81),s=n(23),f=n(27),p=n(80),d=n(7),y=Object(d.a)();var m,h,b;n(154);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=Object(a.b)((function(e){return{login:e.login,loadingError:e.loadingError}}),(function(e){return{doLoginFunc:function(t,n){e(function(e,t){return function(n,r){n(Object(p.d)()),s.a.post("/manage/user/login.do",null,{username:e,password:t}).then((function(e){window.localStorage.setItem("current_user",JSON.stringify(e.data)),n({type:f.a,user:e.data}),n(Object(p.b)()),y.push("/")})).catch((function(e){n(Object(p.c)(e.message))}))}}(t,n))},clearErrorMsgFunc:function(){e(Object(p.a)())},hideLoadingFunc:function(){e(Object(p.b)())}}}))((b=h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(c,e);var t,n,r,a,i=(t=c,function(){var e,n=k(t);if(O()){var r=k(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return w(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e)).handleLogin=t.handleLogin.bind(E(t)),t.handelChange=t.handelChange.bind(E(t)),t.handleKeyDown=t.handleKeyDown.bind(E(t)),t.state={usernameField:{value:"admin",error:""},passwordField:{value:"admin",error:""}},t}return n=c,(r=[{key:"componentDidMount",value:function(){this.props.hideLoadingFunc(),JSON.parse(window.localStorage.getItem("current_user"))&&this.props.history.push("/")}},{key:"handleLogin",value:function(){if(this.validateAndSet("usernameField",this.state.usernameField.value)&&this.validateAndSet("passwordField",this.state.passwordField.value)){var e=this.state,t=e.usernameField,n=e.passwordField;this.props.doLoginFunc(t.value,n.value)}}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.handleLogin()}},{key:"validateAndSet",value:function(e,t){var n="";return t?"usernameField"===e?(t.length<3||t.length>60)&&(n="用户名长度为3-60"):"passwordField"===e&&(t.length<5||t.length>60)&&(n="密码长度为5-60"):n="不能为空",this.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,{value:t,error:n})),!n}},{key:"handelChange",value:function(e,t){var n=t.target.value;this.validateAndSet(e,n)}},{key:"render",value:function(){var e=this,t=this.props.loadingError,n=t.isLoading,r=t.errorMsg,a=this.state,i=a.usernameField,c=a.passwordField,s=i.value,f=c.value,p=i.error,d=c.error;return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"notice"},"注意：线上存在缺陷，因为使用的跨域代理网站并不支持cookie，所以即使登录成功也不会保存cookie，导致下次call api的时候还是认为没有登录。欲查看完整效果，可下载到本地，自行配置反向代理。"),o.a.createElement("h1",null,"后台管理系统"),r&&o.a.createElement(l.a,{onOk:function(){return e.props.clearErrorMsgFunc()},onCancel:function(){return e.props.clearErrorMsgFunc()},title:"对话框",visible:!!r},o.a.createElement("p",null,r)),n&&o.a.createElement(u.a,{isFull:!0}),o.a.createElement("div",{className:"form-item"},o.a.createElement("input",{type:"text",value:s,onChange:function(t){return e.handelChange("usernameField",t)},onKeyDown:this.handleKeyDown,placeholder:"用户名",className:p?"error":""}),p&&o.a.createElement("div",{className:"form-error"},p)),o.a.createElement("div",{className:"form-item"},o.a.createElement("input",{type:"password",value:f,onChange:function(t){return e.handelChange("passwordField",t)},onKeyDown:this.handleKeyDown,placeholder:"密码",className:d?"error":""}),d&&o.a.createElement("div",{className:"form-error"},d)),o.a.createElement("div",{className:"form-item mt20"},o.a.createElement("button",{type:"submit",onClick:this.handleLogin,className:"btn"},"登录")))}}])&&g(n.prototype,r),a&&g(n,a),c}(r.Component),h.propTypes={login:c.a.object,loadingError:c.a.object,doLoginFunc:c.a.func,hideLoadingFunc:c.a.func},m=b))||m},80:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(10);function o(){return{type:r.d}}function a(){return{type:r.b}}function i(e){return{type:r.c,message:e}}function c(){return{type:r.a}}},81:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),o=n.n(r);n(84);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(d,e);var t,n,r,a,p=(t=d,function(){var e,n=s(t);if(l()){var r=s(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return c(this,e)});function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=p.call(this,e)).state={confirmLoading:!1},t.onOk=t.onOk.bind(u(t)),t.onCancel=t.onCancel.bind(u(t)),t.handleKeyDown=t.handleKeyDown.bind(u(t)),t}return n=d,(r=[{key:"componentDidMount",value:function(){var e=this;this.modalContentRef.focus(),this.maskRef.onclick=function(){e.onCancel()}}},{key:"handleKeyDown",value:function(e){27===e.keyCode&&this.onCancel()}},{key:"onOk",value:function(){if(!this.props.confirmLoading){var e=this.props.onOk;"function"==typeof e&&e()}}},{key:"onCancel",value:function(){var e=this.props.onCancel;"function"==typeof e&&e()}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,r=t.children,a=this.props,i=a.visible,c=a.confirmLoading;return n=n||"提示",o.a.createElement("div",{className:"modal-box ".concat(i?"":"hide")},o.a.createElement("div",{className:"modal-mask",ref:function(t){return e.maskRef=t}}),o.a.createElement("div",{className:"modal-content",ref:function(t){return e.modalContentRef=t},tabIndex:"0",onKeyDown:this.handleKeyDown},o.a.createElement("div",{className:"modal-header"},n,o.a.createElement("i",{onClick:this.onCancel,className:"right"},"x")),o.a.createElement("div",{className:"modal-body"},r),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{onClick:this.onCancel,className:"btn default mr10"},"取消"),o.a.createElement("button",{onClick:this.onOk,className:"btn ".concat(c?"disabled":"")},"确定"))))}}])&&i(n.prototype,r),a&&i(n,a),d}(r.Component)},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),o=n.n(r);n(83);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(p,e);var t,n,r,a,f=(t=p,function(){var e,n=l(t);if(u()){var r=l(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return c(this,e)});function p(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e)}return n=p,(r=[{key:"render",value:function(){return o.a.createElement("div",{className:"loading-container ".concat(this.props.isFull?"is-full":"")},o.a.createElement("div",{className:"loading-mask"}),o.a.createElement("div",{className:"loading-box"},o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("span",null)))}}])&&i(n.prototype,r),a&&i(n,a),p}(r.Component)},83:function(e,t,n){},84:function(e,t,n){}}]);