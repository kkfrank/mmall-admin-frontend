/*! Copyright by frank */
webpackJsonp([7],{350:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,c,d,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=n(3),m=o(p),h=n(86),b=n(6),g=o(b),y=n(360),v=o(y),x=n(359),w=o(x),E=n(374),k=n(358);n(375);var _=(u=(0,h.connect)(function(e){return{login:e.login,loadingError:e.loadingError}},function(e){return{doLoginFunc:function(t,n){e((0,E.doLogin)(t,n))},clearErrorMsgFunc:function(){e((0,k.clearErrorMsg)())},hideLoadingFunc:function(){e((0,k.hideLoading)())}}}))((d=c=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleLogin=n.handleLogin.bind(n),n.handelChange=n.handelChange.bind(n),n.handleKeyDown=n.handleKeyDown.bind(n),n.state={usernameField:{value:"admin",error:""},passwordField:{value:"admin",error:""}},n}return l(t,e),f(t,[{key:"componentDidMount",value:function(){this.props.hideLoadingFunc(),JSON.parse(window.localStorage.getItem("current_user"))&&this.props.history.push("/")}},{key:"handleLogin",value:function(){if(this.validateAndSet("usernameField",this.state.usernameField.value)&&this.validateAndSet("passwordField",this.state.passwordField.value)){var e=this.state,t=e.usernameField,n=e.passwordField;this.props.doLoginFunc(t.value,n.value)}}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.handleLogin()}},{key:"validateAndSet",value:function(e,t){var n="";return t?"usernameField"===e?(t.length<3||t.length>60)&&(n="用户名长度为3-60"):"passwordField"===e&&(t.length<5||t.length>60)&&(n="密码长度为5-60"):n="不能为空",this.setState(r({},e,{value:t,error:n})),!n}},{key:"handelChange",value:function(e,t){var n=t.target.value;this.validateAndSet(e,n)}},{key:"render",value:function(){var e=this,t=this.props.loadingError,n=t.isLoading,o=t.errorMsg,r=this.state,a=r.usernameField,i=r.passwordField,l=a.value,u=i.value,s=a.error,c=i.error;return m.default.createElement("div",{className:"container"},m.default.createElement("div",{className:"notice"},"注意：线上存在缺陷，因为使用的跨域代理网站并不支持cookie，所以即使登录成功也不会保存cookie，导致下次call api的时候还是认为没有登录。欲查看完整效果，可下载到本地，自行配置反向代理。"),m.default.createElement("h1",null,"后台管理系统"),o&&m.default.createElement(w.default,{onOk:function(){return e.props.clearErrorMsgFunc()},onCancel:function(){return e.props.clearErrorMsgFunc()},title:"对话框",visible:!!o},m.default.createElement("p",null,o)),n&&m.default.createElement(v.default,{isFull:!0}),m.default.createElement("div",{className:"form-item"},m.default.createElement("input",{type:"text",value:l,onChange:function(t){return e.handelChange("usernameField",t)},onKeyDown:this.handleKeyDown,placeholder:"用户名",className:s?"error":""}),s&&m.default.createElement("div",{className:"form-error"},s)),m.default.createElement("div",{className:"form-item"},m.default.createElement("input",{type:"password",value:u,onChange:function(t){return e.handelChange("passwordField",t)},onKeyDown:this.handleKeyDown,placeholder:"密码",className:c?"error":""}),c&&m.default.createElement("div",{className:"form-error"},c)),m.default.createElement("div",{className:"form-item mt20"},m.default.createElement("button",{type:"submit",onClick:this.handleLogin,className:"btn"},"登录")))}}]),t}(p.Component),c.propTypes={login:g.default.object,loadingError:g.default.object,doLoginFunc:g.default.func,hideLoadingFunc:g.default.func},s=d))||s;t.default=_},358:function(e,t,n){"use strict";function o(){return{type:l.SHOW_LOADING}}function r(){return{type:l.HIDE_LOADING}}function a(e){return{type:l.SET_ERROR_MESSAGE,message:e}}function i(){return{type:l.CLAER_ERROR_MESSAGE}}Object.defineProperty(t,"__esModule",{value:!0}),t.showLoading=o,t.hideLoading=r,t.setErrorMsg=a,t.clearErrorMsg=i;var l=n(151)},359:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(3),u=function(e){return e&&e.__esModule?e:{default:e}}(l);n(363);var s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={confirmLoading:!1},n.onOk=n.onOk.bind(n),n.onCancel=n.onCancel.bind(n),n.handleKeyDown=n.handleKeyDown.bind(n),n}return a(t,e),i(t,[{key:"componentDidMount",value:function(){var e=this;this.modalContentRef.focus(),this.maskRef.onclick=function(){e.onCancel()}}},{key:"handleKeyDown",value:function(e){console.log("keydown"),27===e.keyCode&&this.onCancel()}},{key:"onOk",value:function(){if(!this.props.confirmLoading){var e=this.props.onOk;"function"==typeof e&&e()}}},{key:"onCancel",value:function(){var e=this.props.onCancel;"function"==typeof e&&e()}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,o=t.children,r=this.props,a=r.visible,i=r.confirmLoading;return n=n||"提示",u.default.createElement("div",{className:"modal-box "+(a?"":"hide")},u.default.createElement("div",{className:"modal-mask",ref:function(t){return e.maskRef=t}}),u.default.createElement("div",{className:"modal-content",ref:function(t){return e.modalContentRef=t},tabIndex:"0",onKeyDown:this.handleKeyDown},u.default.createElement("div",{className:"modal-header"},n,u.default.createElement("i",{onClick:this.onCancel,className:"right"},"x")),u.default.createElement("div",{className:"modal-body"},o),u.default.createElement("div",{className:"modal-footer"},u.default.createElement("button",{onClick:this.onCancel,className:"btn default mr10"},"取消"),u.default.createElement("button",{onClick:this.onOk,className:"btn "+(i?"disabled":"")},"确定"))))}}]),t}(l.Component);t.default=s},360:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(3),u=function(e){return e&&e.__esModule?e:{default:e}}(l);n(361);var s=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),i(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"loading-container "+(this.props.isFull?"is-full":"")},u.default.createElement("div",{className:"loading-mask"}),u.default.createElement("div",{className:"loading-box"},u.default.createElement("span",null),u.default.createElement("span",null),u.default.createElement("span",null),u.default.createElement("span",null)))}}]),t}(l.Component);t.default=s},361:function(e,t,n){var o=n(362);"string"==typeof o&&(o=[[e.i,o,""]]);var r={};r.transform=void 0;n(348)(o,r);o.locals&&(e.exports=o.locals)},362:function(e,t,n){t=e.exports=n(347)(!1),t.push([e.i,".loading-container{position:fixed;left:260px;top:60px;right:0;bottom:0;z-index:9999}.loading-container.is-full,.loading-mask{left:0;top:0;right:0;bottom:0}.loading-mask{position:absolute;background-color:hsla(0,0%,100%,.7)}.loading-box{position:absolute;left:50%;top:50%;display:inline-block;width:22px;height:22px;-webkit-animation:autoRotate 1.2s infinite linear;animation:autoRotate 1.2s infinite linear;-webkit-transform-origin:50% 50%;transform-origin:50% 50%}.loading-box span{position:absolute;width:10px;height:10px;border-radius:50%;background-color:#1890ff}.loading-box span:first-child{left:0;top:0}.loading-box span:nth-child(2){left:12px;top:0;opacity:.9}.loading-box span:nth-child(3){left:0;top:12px;opacity:.6}.loading-box span:nth-child(4){left:12px;top:12px;opacity:.3}@-webkit-keyframes autoRotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes autoRotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},363:function(e,t,n){var o=n(364);"string"==typeof o&&(o=[[e.i,o,""]]);var r={};r.transform=void 0;n(348)(o,r);o.locals&&(e.exports=o.locals)},364:function(e,t,n){t=e.exports=n(347)(!1),t.push([e.i,".modal-box{position:fixed;z-index:9999}.modal-box .modal-mask{position:fixed;top:0;right:0;bottom:0;left:0;height:100%;background-color:rgba(0,0,0,.45)}.modal-box .modal-content{position:fixed;left:50%;top:50%;min-width:280px;max-width:500px;background-color:#fff;border-radius:4px;-webkit-box-shadow:0 4px 12px rgba(0,0,0,.15);box-shadow:0 4px 12px rgba(0,0,0,.15);margin-top:-100px;-webkit-transform:translate(-50%);transform:translate(-50%);outline:0}.modal-box .modal-header{padding:16px 24px;border-bottom:1px solid #e8e8e8}.modal-box .modal-header i{cursor:pointer;position:absolute;right:0;top:0;padding:10px 18px;font-size:20px}.modal-box .modal-body{padding:24px}.modal-box .modal-footer{padding:10px 16px;text-align:right}",""])},374:function(e,t,n){"use strict";function o(e,t){return function(n,o){n((0,l.showLoading)()),a.default.post("/manage/user/login.do",null,{username:e,password:t}).then(function(e){window.localStorage.setItem("current_user",JSON.stringify(e.data)),n({type:i.LOGIN_SUCCESS,user:e.data}),n((0,l.hideLoading)()),s.push("/")}).catch(function(e){n((0,l.setErrorMsg)(e.message))})}}Object.defineProperty(t,"__esModule",{value:!0}),t.doLogin=o;var r=n(150),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n(153),l=n(358),u=n(14),s=(0,u.createHashHistory)()},375:function(e,t,n){var o=n(376);"string"==typeof o&&(o=[[e.i,o,""]]);var r={};r.transform=void 0;n(348)(o,r);o.locals&&(e.exports=o.locals)},376:function(e,t,n){t=e.exports=n(347)(!1),t.push([e.i,".container{width:300px;margin:200px auto 0}.container .notice{position:absolute;top:10px;left:50%;max-width:640px;min-width:300px;padding:20px 0;color:#ff4d4f;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.container h1{font-size:20px;color:#1890ff;font-weight:500;margin-bottom:20px;text-align:center}.container .form-item{position:relative;margin-bottom:24px}.container .form-item .form-control,.container .form-item input{display:inline-block;background-color:#fff;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;color:#606266;height:40px;line-height:40px;padding:0 10px;width:100%}.container .form-item .form-control.error,.container .form-item input.error{border-color:#f56c6c}.container .form-item .form-error{position:absolute;top:100%;left:0;color:#f56c6c;font-size:12px;padding-top:4px}.container .form-item .btn{width:100%}",""])}});
//# sourceMappingURL=7.3fc113f4.js.map